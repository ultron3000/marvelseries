<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Black Panther's Quest</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- HLS.js (kept for HLS support) -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.1/dist/hls.min.js"></script>

  <style>
    :root {--avengers-blue:#0b63b6;--avengers-gold:#ffcc00;--site-dark:#0f1720;}
    body{font-family:'Montserrat',sans-serif;background-color:var(--site-dark);color:#fff;}
    .title-font{font-family:'Bebas Neue',sans-serif;letter-spacing:1px;}
    .gradient-text{background:linear-gradient(90deg,var(--avengers-gold),#ffb84d);-webkit-background-clip:text;background-clip:text;color:transparent;}
    .accent-text{background:linear-gradient(90deg,var(--avengers-blue),#2a9df4);-webkit-background-clip:text;background-clip:text;color:transparent;}
    .episode-card{transition:.3s;}
    .episode-card:hover{transform:translateY(-5px);}
  </style>
</head>

<body class="min-h-screen">

<!-- Loading -->
<div id="loading-overlay" class="fixed inset-0 bg-black z-50 flex items-center justify-center">
  <div class="w-10 h-10 border-4 border-yellow-500 border-t-transparent rounded-full animate-spin"></div>
</div>

<!-- Header -->
<header class="sticky top-0 z-40 bg-black/90 backdrop-blur-sm border-b border-yellow-600/20 shadow-lg">
  <div class="container mx-auto px-4 py-3 flex flex-col md:flex-row justify-between items-center">
    <div class="flex items-center space-x-3">
      <div class="w-10 h-10 bg-gradient-to-br from-blue-700 to-blue-500 rounded-full flex items-center justify-center shadow-lg">
        <i class="fas fa-cat text-white text-xl"></i>
      </div>
      <h1 class="text-2xl md:text-3xl font-bold accent-text title-font">Black Panther's Quest</h1>
    </div>
    <div class="flex items-center space-x-4 mt-2 md:mt-0">
    </div>
  </div>
  <div id="search-bar" class="hidden px-4 pb-4 bg-black/80">
    <div class="relative max-w-2xl mx-auto">
      <input type="text" placeholder="Search episodes..." class="w-full bg-gray-900 border border-yellow-600/30 rounded-full py-3 px-5 pl-12 text-white">
      <i class="fas fa-search absolute left-5 top-3.5 text-yellow-500"></i>
    </div>
  </div>
</header>

<main class="container mx-auto px-4 py-8">

  <!-- Hero -->
  <section class="mb-12 relative rounded-xl shadow-2xl overflow-hidden">
    <img src="https://via.placeholder.com/1600x600?text=Avengers+Assemble+-+Black+Panther%27s+Quest" class="w-full h-64 md:h-[32rem] object-cover object-top">
    <div class="absolute inset-0 bg-gradient-to-r from-black via-black/70 to-transparent"></div>
    <div class="absolute bottom-0 left-0 z-20 p-8">
      <p class="text-gray-300 max-w-xl text-sm md:text-base">Avengers Assemble — Season 5. Follow Black Panther and the Avengers through daring missions, political intrigue in Wakanda, and dangerous foes across the globe.</p>
    </div>
  </section>

  <!-- Episodes -->
  <section class="mb-12">
    <h3 class="text-3xl font-bold gradient-text title-font flex items-center mb-6"><i class="fas fa-list-ul text-yellow-500 mr-3"></i> Season 5 · 23 Episodes</h3>
    <div id="episodes" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
  </section>
</main>

<!-- Video Modal -->
<div id="video-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/90 p-4">
  <div class="relative w-full max-w-4xl bg-gray-900 rounded-xl overflow-hidden shadow-2xl">
    <button id="close-video-modal" class="absolute top-4 right-4 bg-black/70 text-white w-10 h-10 rounded-full flex items-center justify-center"><i class="fas fa-times text-xl"></i></button>
    <video id="modal-video" class="w-full" controls playsinline></video>
    <h3 id="video-title" class="text-xl font-bold p-4 gradient-text text-center"></h3>
  </div>
</div>

<script>
/* ===== EPISODES DATA (REPLACED) =====
   Note: 'video' fields are sample MP4 placeholders so clicking plays a video right away.
   Replace each ep.video value with your actual episode URL (mp4 or .m3u8).
*/
const episodes = [
  { title: "Black Panther's Quest — Episode 01: Rising Shadows", video: "https://scvo.zenithstrategylabs.online/v4/xq/gmez5/index-f1-v1-a1.txt", image: "https://via.placeholder.com/800x450?text=BPQ+E01", description: "T'Challa faces a new threat that tests his leadership and the Avengers' trust.", duration: "22 min", rating: 4.8, releaseDate: "2025-01-01" },
  { title: "Black Panther's Quest — Episode 02: Wakandan Threads", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E02", description: "A political conspiracy in Wakanda forces secret alliances.", duration: "22 min", rating: 4.7, releaseDate: "2025-01-08" },
  { title: "Black Panther's Quest — Episode 03: Echoes of Midnight", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E03", description: "Black Panther and the team hunt a shadowy organization with ties to Vibranium.", duration: "22 min", rating: 4.7, releaseDate: "2025-01-15" },
  { title: "Black Panther's Quest — Episode 04: Broken Vows", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E04", description: "An old ally's betrayal puts T'Challa in a moral dilemma.", duration: "22 min", rating: 4.6, releaseDate: "2025-01-22" },
  { title: "Black Panther's Quest — Episode 05: The Sound of War", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E05", description: "Battlefronts expand as global powers scramble for Wakanda's protection.", duration: "22 min", rating: 4.8, releaseDate: "2025-01-29" },
  { title: "Black Panther's Quest — Episode 06: Labyrinth of Kings", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E06", description: "A cryptic relic draws T'Challa into a deadly maze beneath Wakanda.", duration: "22 min", rating: 4.6, releaseDate: "2025-02-05" },
  { title: "Black Panther's Quest — Episode 07: Cloak and Dagger", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E07", description: "Stealth missions push the Avengers to their limits behind enemy lines.", duration: "22 min", rating: 4.5, releaseDate: "2025-02-12" },
  { title: "Black Panther's Quest — Episode 08: Wakanda Under Siege", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E08", description: "A coordinated strike threatens the heart of Wakanda.", duration: "22 min", rating: 4.9, releaseDate: "2025-02-19" },
  { title: "Black Panther's Quest — Episode 09: The Lost Protocol", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E09", description: "An old protocol resurfaces that could change the balance of power.", duration: "22 min", rating: 4.6, releaseDate: "2025-02-26" },
  { title: "Black Panther's Quest — Episode 10: Broken Crown", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E10", description: "T'Challa must reconcile throne duties with the needs of his friends.", duration: "22 min", rating: 4.7, releaseDate: "2025-03-05" },
  { title: "Black Panther's Quest — Episode 11: Web of Lies", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E11", description: "Deception from within threatens to tear the Avengers apart.", duration: "22 min", rating: 4.5, releaseDate: "2025-03-12" },
  { title: "Black Panther's Quest — Episode 12: Nightfall Rising", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E12", description: "A night mission exposes secrets best left buried.", duration: "22 min", rating: 4.6, releaseDate: "2025-03-19" },
  { title: "Black Panther's Quest — Episode 13: Allies & Adversaries", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E13", description: "Tense alliances are forged; enemies reveal their true designs.", duration: "22 min", rating: 4.8, releaseDate: "2025-03-26" },
  { title: "Black Panther's Quest — Episode 14: Riftwalkers", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E14", description: "A sci-tech anomaly opens paths to dangerous new arenas.", duration: "22 min", rating: 4.7, releaseDate: "2025-04-02" },
  { title: "Black Panther's Quest — Episode 15: Heart of the Panther", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E15", description: "T'Challa confronts personal stakes that could cost everything.", duration: "22 min", rating: 4.9, releaseDate: "2025-04-09" },
  { title: "Black Panther's Quest — Episode 16: The Shifting Guard", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E16", description: "A trusted protector's loyalties come into question.", duration: "22 min", rating: 4.6, releaseDate: "2025-04-16" },
  { title: "Black Panther's Quest — Episode 17: Fractured Nations", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E17", description: "Geopolitics and Vibranium greed spark an international crisis.", duration: "22 min", rating: 4.5, releaseDate: "2025-04-23" },
  { title: "Black Panther's Quest — Episode 18: Veil of Secrets", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E18", description: "Hidden histories surface that change Wakanda's future.", duration: "22 min", rating: 4.8, releaseDate: "2025-04-30" },
  { title: "Black Panther's Quest — Episode 19: The Long Night", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E19", description: "A siege tests the Avengers' endurance through darkness.", duration: "22 min", rating: 4.9, releaseDate: "2025-05-07" },
  { title: "Black Panther's Quest — Episode 20: The Price of Power", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E20", description: "Choices are made that have consequences across the world.", duration: "22 min", rating: 4.7, releaseDate: "2025-05-14" },
  { title: "Black Panther's Quest — Episode 21: Echoes and Ashes", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E21", description: "Past actions come back to haunt present plans.", duration: "22 min", rating: 4.8, releaseDate: "2025-05-21" },
  { title: "Black Panther's Quest — Episode 22: Twilight War", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E22", description: "A massive confrontation looms as factions collide.", duration: "22 min", rating: 4.9, releaseDate: "2025-05-28" },
  { title: "Black Panther's Quest — Episode 23: Crown & Consequence (Season Finale)", video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", image: "https://via.placeholder.com/800x450?text=BPQ+E23", description: "A climactic finale — loyalties, legacy, and the future of Wakanda are decided.", duration: "26 min", rating: 5.0, releaseDate: "2025-06-04" }
];

const container = document.getElementById("episodes");
const modalVideo = document.getElementById("modal-video");
const videoModal = document.getElementById("video-modal");
const videoTitle = document.getElementById("video-title");
let currentHls = null;

/* ===== helper functions ===== */
function isHls(url){return url && (url.includes(".m3u8")||url.includes("index")||url.endsWith(".m3u8"));}
function isYouTube(url){ return url && (url.includes("youtube.com/watch")||url.includes("youtu.be")); }

/* Play video in modal. NOTE: this simple player supports MP4 and HLS.
   If you want to play YouTube links directly, you'll need to swap to an iframe YouTube player.
*/
function playInModal(title,url){
  if(currentHls){currentHls.destroy();currentHls=null;}
  modalVideo.pause();modalVideo.removeAttribute("src");modalVideo.load();
  videoTitle.textContent=title;

  if(!url){
    // fallback: do nothing if no URL
    videoTitle.textContent = title + " — No playable URL provided";
    showModal();
    return;
  }

  // If YouTube link detected — show message (user may later replace logic to use iframe)
  if(isYouTube(url)){
    // Simple fallback: open YouTube in new tab (recommended to implement iframe player if you need inline playback)
    window.open(url, "_blank");
    return;
  }

  if(isHls(url)){
    if(Hls.isSupported()){
      currentHls=new Hls();
      currentHls.loadSource(url);
      currentHls.attachMedia(modalVideo);
      currentHls.on(Hls.Events.MANIFEST_PARSED,()=>{showModal();modalVideo.play();});
    } else {
      modalVideo.src=url;showModal();modalVideo.play();
    }
  } else {
    // assume MP4 or direct video file
    modalVideo.src=url;showModal();modalVideo.play();
  }
}

function showModal(){ videoModal.classList.remove("hidden"); document.body.style.overflow="hidden"; }
function closePlayer(){
  if(currentHls){currentHls.destroy();currentHls=null;}
  modalVideo.pause(); modalVideo.removeAttribute("src");
  videoModal.classList.add("hidden"); document.body.style.overflow="";
}

/* Build episode cards */
episodes.forEach((ep,i)=>{
  const card=document.createElement("div");
  card.className="episode-card bg-gray-900/50 rounded-xl overflow-hidden border border-gray-800 cursor-pointer";
  card.innerHTML=`
    <div class="relative group">
      <img src="${ep.image}" class="w-full h-40 object-cover group-hover:opacity-80">
      <div class="absolute top-3 left-3 bg-blue-600 w-8 h-8 rounded-full flex items-center justify-center text-white font-bold">${i+1}</div>
      <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition">
        <div class="bg-yellow-600 text-black rounded-full w-12 h-12 flex items-center justify-center"><i class="fas fa-play"></i></div>
      </div>
    </div>
    <div class="p-4">
      <h3 class="font-semibold">${ep.title}</h3>
      <p class="text-xs text-gray-400 line-clamp-2">${ep.description}</p>
    </div>`;
  card.addEventListener("click",()=> {
    // If the episode video is a YouTube link, open in new tab (you can change to inline iframe behaviour)
    if(isYouTube(ep.video)){
      window.open(ep.video, "_blank");
    } else {
      playInModal(ep.title, ep.video);
    }
  });
  container.appendChild(card);
});

/* Close Modal */
document.getElementById("close-video-modal").onclick=closePlayer;
videoModal.onclick=e=>{ if(e.target===videoModal) closePlayer(); }

/* Remove fake loader */
setTimeout(()=>document.getElementById("loading-overlay").classList.add("hidden"),800);

/* Search toggle */
document.getElementById("search-btn").addEventListener("click", ()=>{
  const bar = document.getElementById("search-bar");
  bar.classList.toggle("hidden");
});
</script>

</body>
</html>
